---
import PubDate from '@components/PubDate.astro';
import H2 from '@components/H2.astro';
import H3 from '@components/H3.astro';
import H4 from '@components/H4.astro';
import H5 from '@components/H5.astro';
import H6 from '@components/H6.astro';

const { entries } = Astro.props;

// Custom heading components for offset
const headingComponents = {
	h2: H2,
	h3: H3,
	h4: H4,
	h5: H5,
	h6: H6,
};
---

<ul role="list">
	{
		// @ts-expect-error -- `entry` is a union of multiple CollectionEntry types.
		// Each variant has different fields (`via`, `Content`, `absoluteURL`, etc.),
		// so TS requires exhaustive narrowing. At runtime, all accessed fields exist
		// for the specific entry we're working with, making this safe.
		entries.map((entry) => {
			return (
				<li class="entry-item">
					<div class="center p-space-m">
						<article class="stack align-self-stretch">
							{entry.collection === 'articles' && (
								<h2>
									<a href={entry.absoluteURL}>{entry.data.title}</a>
								</h2>
							)}
							{entry.collection === 'links' && (
								<h2 class="link-entry-title">
									<a href={entry.data.link}>{entry.data.title}</a>
								</h2>
							)}
							<div class="entry-content flow">
								<entry.Content components={headingComponents} />
							</div>
							<footer class="cluster text-step--1">
								<a
									class="text-box-trim"
									href={entry.absoluteURL}
									rel="bookmark"
								>
									<PubDate as="span" date={entry.data.pubDate} />
								</a>
							</footer>
						</article>
					</div>
				</li>
			);
		})
	}
</ul>
