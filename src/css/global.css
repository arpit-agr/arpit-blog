@view-transition {
	navigation: auto;
}

:root {
	--wrapper-max-width: 73rem;
	--measure: 60ch;
	--sidebar-min-width: 24rem;
	--gutter: var(--space-m);
	--center-max-width: var(--measure);

	@custom-media --wrapper-max-width (width > 73rem);
	/* the vw size at which the page layout switches to two columns */
	@custom-media --layout-with-sidebar (width > 68.5625rem);

	--font-mono: ui-monospace, 'SF Mono', monospace;

	--button-padding-block: 0.5em;
	--button-padding-inline: 0.75ch;
	--btn-border-radius: 100vmax;
}

:root {
	color-scheme: light dark;
	scrollbar-gutter: stable;
}

body {
	max-inline-size: var(--wrapper-max-width);
	margin-inline: auto;
	background-color: var(--color-bg-primary);
	color: var(--color-text-primary);
	accent-color: var(--color-accent);
	font-family: var(--font-sans-serif);
	font-size: var(--step-0);
	font-size-adjust: from-font;
	font-weight: var(--font-regular);
	line-height: var(--leading-normal);
	-webkit-font-smoothing: auto;

	@media (prefers-color-scheme: dark) {
		-webkit-font-smoothing: antialiased;
	}

	@media (--layout-with-sidebar) {
		background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='4' height='4' viewBox='0 0 4 4'%3E%3Cpath fill='%23c3bdcd' fill-opacity='0.3' d='M1 3h1v1H1V3zm2-2h1v1H3V1z'%3E%3C/path%3E%3C/svg%3E");
		background-size: 0.15lh 0.15lh;
		background-position: 0px 0px;

		@media (prefers-color-scheme: dark) {
			background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='4' height='4' viewBox='0 0 4 4'%3E%3Cpath fill='%23443d51' fill-opacity='0.3' d='M1 3h1v1H1V3zm2-2h1v1H3V1z'%3E%3C/path%3E%3C/svg%3E");
		}
	}
}

h1,
.heading-1,
h2,
.heading-2,
h3,
.heading-3,
h4,
.heading-4 {
	font-weight: var(--font-bold);
}

h1,
.heading-1 {
	font-size: var(--step-3);
	line-height: var(--leading-snug);
}

h2,
.heading-2 {
	font-size: var(--step-1);
	line-height: var(--leading-normal);
}

h3,
.heading-3 {
	font-size: var(--step-0);
	line-height: var(--leading-normal);
	letter-spacing: var(--tracking-wide);
}

h4,
.heading-4 {
	font-size: var(--step--2);
	text-transform: uppercase;
	line-height: var(--leading-normal);
	letter-spacing: var(--tracking-widest);
}

a {
	text-decoration-thickness: max(var(--border-thickness-l), 0.2ex);
	text-decoration-color: var(--color-underline);
	text-decoration-skip-ink: none;
	/*transition:
		text-decoration-thickness 0.2s cubic-bezier(0.25, 0, 0.3, 1),
		text-underline-offset 0.2s cubic-bezier(0.25, 0, 0.3, 1);*/

	@media (prefers-color-scheme: dark) {
		text-shadow: var(--color-bg-primary) 0 var(--space-5xs);
	}

	&:hover,
	&:focus-visible {
		text-decoration-thickness: 0.3lh;
		text-underline-offset: -0.15lh;
	}
}

button,
.btn,
input {
	border: none;
	padding: var(--button-padding-block) var(--button-padding-inline);
	outline: var(--border-thickness-m) solid var(--color-border);
	border-radius: var(--btn-border-radius);
	transition-property: background, outline-color, opacity;
	transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
	transition-duration: 300ms;

	&:focus-visible {
		background: var(--color-bg-button-hover);
	}
}

button,
.btn {
	background: var(--color-bg-button);

	&:hover {
		background: var(--color-bg-button-hover);
		outline-color: var(--color-focus);
	}
}

input {
	background: var(--color-bg-primary);
}

:where(ol, ul):not([role='list']) {
	padding-inline-start: var(--gutter);

	> * + * {
		margin-block-start: var(--flow-space, var(--space-3xs));
	}

	> li {
		--flow-space: 0.25lh;
	}
}

:where(ul):not([role='list']) {
	list-style: square;

	::marker {
		color: var(--color-accent);
	}
}

blockquote {
	position: relative;
	margin-inline-start: 1ch;
	padding-inline-start: var(--space-s);
	border-inline-start: var(--border-thickness-blockquote) solid transparent;
	border-image: linear-gradient(
			to bottom,
			transparent 0,
			transparent 1lh,
			oklch(from currentColor l c h / calc(0.75 * alpha)) 1lh,
			oklch(from currentColor l c h / calc(0.75 * alpha)) calc(100% - 0.3lh),
			transparent calc(100% - 0.3lh)
		)
		1;

	> * + * {
		margin-block-start: var(--flow-space, 0.5lh);
	}

	> * {
		--flow-space: 0.5lh;
	}

	> *:first-child::before {
		content: open-quote;
		font-size: var(--step-4);
		line-height: var(--leading-flat);
		color: oklch(from currentColor l c h / calc(0.875 * alpha));

		position: absolute;
		inset-inline-start: calc(-1 * var(--border-thickness-blockquote));
		inset-block-start: 0;
		translate: -35% 0%;
	}

	> *:last-child::after {
		content: close-quote;

		/* visually hidden */
		position: absolute;
		block-size: 1px;
		inline-size: 1px;
		clip: rect(0 0 0 0);
		clip-path: inset(50%);
		overflow: hidden;
		white-space: nowrap;
	}
}

pre,
code {
	font-family: var(--font-mono);
	font-size: var(--code-font-size);
	font-weight: var(--code-font-weight);
	line-height: var(--leading-relaxed);
}

pre {
	padding: var(--code-padding-block) var(--code-padding-inline);
	border-radius: var(--code-border-radius);
}

:not(pre) > code {
	padding: 0px var(--space-3xs);
	border-radius: var(--code-border-radius);
	outline: var(--code-border-thickness) solid var(--color-border);
	outline-offset: calc(-1 * var(--code-border-thickness));
}

mark {
	--circled-color: currentColor;
	--circle-padding: -0.5ch;

	position: relative;
	background: none;
	color: currentColor;

	&::before,
	&::after {
		content: '';
		position: absolute;
		border: var(--border-thickness-l) solid var(--color-border);
		inset: var(--circle-padding);
	}

	&::before {
		inset-block-start: calc(var(--circle-padding) / 2);
		inset-inline-end: 50%;
		border-inline-end: none;
		border-radius: 100% 0 0 75% / 50% 0 0 50%;
	}

	&::after {
		inset-inline-start: 30%;
		border-inline-start: none;
		border-radius: 0 100% 75% 0 / 0 50% 50% 0;
	}
}

::selection {
	background-color: var(--color-bg-selection);
}

:focus-visible {
	outline: var(--border-thickness-focus) solid var(--color-focus);
}

:target {
	scroll-margin-block-start: calc(calc(2 * (1.25 * var(--space-s))) + 1ex);
}
